<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Newfound Living - Rental Application</title>
  <meta name="description" content="Submit your rental application to Newfound Living quickly and securely." />
  <link rel="icon" type="image/png" href="tinylogo1.png" />
  <style>
    :root {
      --brand: #21706A;           /* branded accent color (used for buttons) */
      --brand-hover: #1b5c53;
      --white: #ffffff;
      --dark-overlay: rgba(0, 0, 0, 0.6);
      --input-bg: rgba(255 255 255 / 0.12);
      --input-border: rgba(255 255 255 / 0.18);
      --form-bg: rgba(0, 0, 0, 0.85);
      --fieldset-bg: rgba(255,255,255,0.02); /* translucent section box */
      --fieldset-border: rgba(255,255,255,0.04);
    }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body, html {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      min-height: 100vh;
      background: url('city.png') no-repeat center center fixed;
      background-size: cover;
      color: var(--white);
      position: relative;
    }
    .overlay {
      background: var(--dark-overlay);
      position: fixed;
      inset: 0;
      z-index: 0;
    }
    .logo {
      width: 260px;
      margin: 2rem auto 1rem;
      display: block;
      z-index: 1;
      position: relative;
    }
    .container {
      position: relative;
      z-index: 1;
      max-width: 700px;
      margin: 3rem auto 6rem;
      padding: 2rem 2rem 3rem;
      background-color: var(--form-bg);
      border-radius: 10px;
      box-shadow: 0 0 15px rgba(0,0,0,0.6);
      text-align: left;
    }
    h1 {
      font-size: 2rem;
      font-family: Georgia, serif;
      margin-bottom: 1rem;
      text-align: center;
    }

    /* Fieldset boxes: translucent separated sections */
    fieldset {
      border: 1px solid var(--fieldset-border);
      background: linear-gradient(180deg, rgba(255,255,255,0.015), rgba(255,255,255,0.01));
      backdrop-filter: blur(6px);
      padding: 1rem 1rem 1.1rem;
      margin-bottom: 1.25rem;
      border-radius: 8px;
    }
    fieldset legend {
      font-weight: 700;
      padding: 0 0.4rem;
      margin-left: 0.2rem;
    }

    label {
      display: block;
      margin-bottom: 0.3rem;
      font-weight: 600;
      font-size: 0.95rem;
    }
    input[type="text"],
    input[type="email"],
    input[type="date"],
    input[type="tel"],
    textarea,
    select,
    input[type="number"],
    input[type="url"] {
      width: 100%;
      padding: 0.5rem 0.75rem;
      margin-bottom: 1rem;
      border-radius: 6px;
      border: 1px solid var(--input-border);
      background-color: var(--input-bg);
      color: var(--white);
      font-size: 1rem;
      font-family: inherit;
    }
    textarea { resize: vertical; min-height: 80px; }
    input[type="checkbox"], input[type="radio"] {
      margin-right: 0.4rem;
      transform: scale(1.05);
      vertical-align: middle;
    }
    .checkbox-group {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      margin-bottom: 1rem;
      flex-wrap: wrap;
    }
    .checkbox-group label {
      margin: 0;
      font-weight: normal;
      font-size: 0.95rem;
      cursor: pointer;
      color: var(--white);
    }

    /* Buttons updated to brand color */
    button, .file-btn {
      background-color: var(--brand);
      color: var(--white);
      border: none;
      padding: 0.75rem 1.25rem;
      font-size: 1rem;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 700;
      width: 100%;
      max-width: 320px;
      margin: 1rem auto 0;
      display: block;
      transition: background-color 0.15s ease;
      text-align: center;
      user-select: none;
    }
    button:hover, .file-btn:hover { background-color: var(--brand-hover); }

    /* smaller helper button (paste) */
    .btn-mini {
      background: var(--brand);
      color: var(--white);
      border: none;
      border-radius: 6px;
      padding: 0.4rem 0.8rem;
      cursor: pointer;
      font-weight:700;
      font-size:0.92rem;
    }
    .btn-mini:hover { background: var(--brand-hover); }

    input[type="file"] { display: none; }
    label.file-label {
      display: block;
      max-width: 320px;
      margin: 0.5rem auto 1rem;
      cursor: pointer;
      font-weight: bold;
      font-size: 1rem;
      border-radius: 8px;
      padding: 0.75rem 1.5rem;
      background-color: var(--brand);
      color: var(--white);
      text-align: center;
      transition: background-color 0.15s;
      user-select: none;
    }
    label.file-label:hover { background-color: var(--brand-hover); }

    #thank-you-rental {
      display: none;
      margin-top: 1rem;
      font-size: 1.1rem;
      color: lightgreen;
      text-align: center;
    }
    footer {
      position: relative;
      z-index: 1;
      margin-top: 3rem;
      font-size: 1rem;
      color: #ffffff;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      gap: 0.5rem;
      padding: 0.75rem 1rem;
      border-radius: 8px;
      max-width: fit-content;
      margin-left: auto;
      margin-right: auto;
      background-color: rgba(0, 0, 0, 0.4);
    }
    footer a {
      color: #ffffff;
      text-decoration: underline;
      margin-left: 0.25rem;
      font-size: 1rem;
      font-weight: 500;
      display: inline-flex;
      align-items: center;
      gap: 0.3rem;
    }
    .social-link, .email-link {
      display: inline-flex;
      align-items: center;
      gap: 0.25rem;
    }
    .social-link img, .email-link img { width: 16px; height: 16px; }
    .privacy {
      margin-top: 1rem;
      font-size: 0.9rem;
      color: #dddddd;
      text-align: center;
    }

    /* Paste button styling moved and centered */
    .paste-centered {
      display: block;
      margin: 8px auto 0;
      width: 140px;
      padding: 0.38rem 0.6rem;
      font-size: 0.9rem;
      border-radius: 6px;
      text-align: center;
      background: var(--brand);
      color: var(--white);
      border: none;
    }
    .paste-centered:hover { background: var(--brand-hover); }

    .helper { font-size:0.95rem; color: #dddddd; margin-top:0.3rem; }
    .proof-options { display:flex; gap:12px; align-items:center; margin-top:8px; flex-wrap:wrap; }
    .proof-flow { margin-top:12px; }
    .proof-flow .inline-row { display:flex; gap:8px; max-width:760px; }
    .proof-flow input[type="url"] { flex:1; }

    @media (max-width:560px) {
      .container { padding: 1.4rem; margin: 2rem 1rem 4rem; }
      button, .file-btn { max-width: 100%; }
      .paste-centered { width: 46%; }
    }
  </style>
</head>
<body>
  <div class="overlay"></div>
  <img src="logo-transparent.png" alt="Newfound Living Logo" class="logo" />
  <div class="container" role="main" aria-label="Rental Application Form">
    <h1>Rental Application</h1>
    <form id="rental-form" action="https://formspree.io/f/xldnwbqq" method="POST" novalidate>
      <fieldset>
        <label for="property-address">Property Address</label>
        <input type="text" id="property-address" name="property_address" required placeholder="e.g., 123 Main St" />
        <div class="checkbox-group" role="group" aria-label="Rental Unit">
          <label><input type="checkbox" name="rental_unit_main" value="Main Unit" /> Main Unit</label>
          <label><input type="checkbox" name="rental_unit_basement" value="Basement Apartment" /> Basement Apartment</label>
          <label>
            <input type="checkbox" name="rental_unit_other" value="Other" /> Other:
            <input type="text" name="rental_unit_other_text" placeholder="Specify" style="width: 120px; display: inline-block;" />
          </label>
        </div>
        <label for="move-in-date">Desired Move-in Date</label>
        <input type="date" id="move-in-date" name="move_in_date" required />
      </fieldset>

      <fieldset>
        <legend><strong>Applicant Information</strong></legend>
        <label for="full-name">Full Name</label>
        <input type="text" id="full-name" name="full_name" required />
        <label for="dob">Date of Birth</label>
        <input type="date" id="dob" name="date_of_birth" required />
        <label for="phone">Phone Number</label>
        <input type="tel" id="phone" name="phone_number" required />
        <label for="email">Email Address</label>
        <input type="email" id="email" name="email_address" required />
        <label for="current-address">Current Address</label>
        <input type="text" id="current-address" name="current_address" required />
        <label for="landlord-name">Landlord’s Name</label>
        <input type="text" id="landlord-name" name="landlord_name" />
        <label for="landlord-phone">Landlord’s Phone</label>
        <input type="tel" id="landlord-phone" name="landlord_phone" />
        <label for="reason-leaving">Reason for Leaving</label>
        <textarea id="reason-leaving" name="reason_for_leaving"></textarea>
        <label for="length-tenancy">Length of Tenancy</label>
        <input type="text" id="length-tenancy" name="length_of_tenancy" placeholder="e.g., 2 years" />
      </fieldset>

      <fieldset>
        <legend><strong>Employment / Income Verification</strong></legend>
        <label for="employer-name">Employer Name</label>
        <input type="text" id="employer-name" name="employer_name" required />
        <label for="position">Position</label>
        <input type="text" id="position" name="position" required />
        <label for="monthly-income">Monthly Income (Net)</label>
        <input type="number" id="monthly-income" name="monthly_income" required placeholder="e.g., 3000" />
        <label for="employment-length">Length of Employment</label>
        <input type="text" id="employment-length" name="length_of_employment" placeholder="e.g., 3 years" />

        <!-- REPLACED UPLOAD AREA: only Google Form or Email paths (no direct attach) -->
        <label><strong>Proof of income / Financial Assistance</strong></label>
        <p class="helper">Please either upload using our Google Form (you may be asked to sign in), then paste the confirmation or Drive link below, or click "Email Proof of Income" to open your mail client and attach your documents manually.</p>

        <div class="proof-options" role="radiogroup" aria-label="Proof submission method">
          <label style="display:flex; align-items:center; gap:8px;">
            <input type="radio" name="proof_option" value="google_form" checked /> Google Form
          </label>
          <label style="display:flex; align-items:center; gap:8px;">
            <input type="radio" name="proof_option" value="email" /> Email
          </label>
        </div>

        <div id="google-flow" class="proof-flow" aria-hidden="false">
          <button type="button" id="open-google-form" class="file-btn" aria-label="Open Google Form to upload proof of income">Open Google Form to upload proof</button>

          <div class="inline-row" style="margin-top:10px;">
            <input type="url" id="proof-income-link" name="proof_income_link" placeholder="Paste Google Form confirmation or Drive link here" aria-label="Paste proof link" />
          </div>

          <!-- Paste button moved below the URL input, centered and smaller -->
          <button type="button" id="paste-clipboard" class="paste-centered" title="Paste URL from clipboard" aria-label="Paste link from clipboard">Paste link</button>
        </div>

        <div id="email-flow" class="proof-flow" style="display:none;">
          <p class="helper">Click the button below to open your email client. Attach your proof of income and include your full name & property address in the message so we can match it to your application.</p>
          <button type="button" id="email-proof-btn" class="btn-mini" title="Email proof">Email Proof of Income</button>
        </div>
      </fieldset>

      <fieldset>
        <legend><strong>Additional Occupants</strong></legend>
        <label for="occupant1">1. Name</label>
        <input type="text" id="occupant1" name="additional_occupant_1" />
        <label for="occupant2">2. Name</label>
        <input type="text" id="occupant2" name="additional_occupant_2" />
        <label for="occupant3">3. Name</label>
        <input type="text" id="occupant3" name="additional_occupant_3" />
      </fieldset>

      <fieldset>
        <legend><strong>Pets</strong></legend>
        <div class="checkbox-group" style="margin-bottom:1rem;">
          <label>
            <input type="radio" name="pets" value="Yes" id="pets-yes" /> Yes
          </label>
          <label>
            <input type="radio" name="pets" value="No" id="pets-no" checked /> No
          </label>
        </div>
        <div id="pet-details-section">
          <label for="pet-type">Pet Type</label>
          <select id="pet-type" name="pet_type">
            <option value="">Select pet type</option>
            <option value="Dog">Dog</option>
            <option value="Cat">Cat</option>
            <option value="Bird">Bird</option>
            <option value="Reptile">Reptile</option>
            <option value="Other">Other</option>
          </select>
          <label for="number-of-pets">Number of Pets</label>
          <input type="number" id="number-of-pets" name="number_of_pets" min="1" placeholder="e.g., 2" />
          <label for="breed-size">Breed &amp; Size</label>
          <input type="text" id="breed-size" name="breed_size" placeholder="e.g., Beagle, Medium" />
        </div>
      </fieldset>

      <fieldset>
        <legend><strong>Emergency Contact</strong></legend>
        <label for="emergency-name">Name</label>
        <input type="text" id="emergency-name" name="emergency_contact_name" />
        <label for="emergency-phone">Phone</label>
        <input type="tel" id="emergency-phone" name="emergency_contact_phone" />
        <label for="emergency-relationship">Relationship to Applicant</label>
        <input type="text" id="emergency-relationship" name="emergency_contact_relationship" />
      </fieldset>

      <fieldset>
        <legend><strong>References</strong></legend>
        <label for="reference1-name">1. Name</label>
        <input type="text" id="reference1-name" name="reference_1_name" />
        <label for="reference1-phone">1. Phone</label>
        <input type="tel" id="reference1-phone" name="reference_1_phone" />
        <label for="reference2-name">2. Name</label>
        <input type="text" id="reference2-name" name="reference_2_name" />
        <label for="reference2-phone">2. Phone</label>
        <input type="tel" id="reference2-phone" name="reference_2_phone" />
      </fieldset>

      <fieldset>
        <legend><strong>Declaration</strong></legend>
        <p>I declare that the information provided is true and complete. I understand that providing false information or failing to disclose relevant details may result in denial or termination of tenancy.</p>
        <label for="applicant-signature">Signature</label>
        <input type="text" id="applicant-signature" name="applicant_signature" placeholder="Type your full name" required />
        <label for="applicant-signature-date">Date</label>
        <input type="date" id="applicant-signature-date" name="applicant_signature_date" required />
        <label for="coapplicant-signature">Co-applicant Signature (if applicable)</label>
        <input type="text" id="coapplicant-signature" name="coapplicant_signature" placeholder="Type full name or leave blank" />
        <label for="coapplicant-signature-date">Co-applicant Date</label>
        <input type="date" id="coapplicant-signature-date" name="coapplicant_signature_date" />
      </fieldset>

      <button type="submit">Submit Application</button>
    </form>
    <div id="thank-you-rental" role="alert" aria-live="polite">Thank you for submitting your application. We will review it and contact you shortly.</div>
  </div>
  <footer role="contentinfo" aria-label="Footer">
    <a href="mailto:info.newfoundliving@gmail.com" class="email-link" aria-label="Send email to Newfound Living">
      <img src="email-icon.svg" alt="Email Icon" aria-hidden="true" /> info.newfoundliving@gmail.com
    </a>
    <a href="https://www.facebook.com/profile.php?id=61577097797242" target="_blank" rel="noopener" class="social-link" aria-label="Facebook page">
      <img src="facebook-icon.svg" alt="Facebook Icon" aria-hidden="true" /> Facebook
    </a>
    <div class="privacy">© 2025 Newfound Living | All rights reserved.</div>
  </footer>

  <script>
    (function () {
      // --- Pet details toggle (preserves your original behavior) ---
      const petsYes = document.getElementById('pets-yes');
      const petsNo = document.getElementById('pets-no');
      const petDetailsSection = document.getElementById('pet-details-section');
      function togglePetDetails() {
        if (petsYes && petsYes.checked) {
          petDetailsSection.style.display = '';
        } else {
          petDetailsSection.style.display = 'none';
          const pt = document.getElementById('pet-type');
          const pn = document.getElementById('number-of-pets');
          const bs = document.getElementById('breed-size');
          if (pt) pt.value = '';
          if (pn) pn.value = '';
          if (bs) bs.value = '';
        }
      }
      if (petsYes && petsNo) {
        petsYes.addEventListener('change', togglePetDetails);
        petsNo.addEventListener('change', togglePetDetails);
        togglePetDetails();
      }

      // --- Upload-option behavior ---
      const GOOGLE_FORM_SHORT = 'https://forms.gle/1eoWj53oeUU6LiRk9'; // your short link
      const EMAIL_ADDRESS = 'info.newfoundliving@gmail.com';

      const openGoogleBtn = document.getElementById('open-google-form');
      const pasteBtn = document.getElementById('paste-clipboard');
      const proofLinkInput = document.getElementById('proof-income-link');
      const emailProofBtn = document.getElementById('email-proof-btn');
      const proofOptionRadios = document.querySelectorAll('input[name="proof_option"]');
      const googleFlow = document.getElementById('google-flow');
      const emailFlow = document.getElementById('email-flow');
      const form = document.getElementById('rental-form');

      // Open Google Form in a new tab
      if (openGoogleBtn) {
        openGoogleBtn.addEventListener('click', function () {
          window.open(GOOGLE_FORM_SHORT, '_blank', 'noopener,noreferrer');
        });
        openGoogleBtn.addEventListener('keydown', function (e) {
          if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); openGoogleBtn.click(); }
        });
      }

      // Paste-from-clipboard helper
      if (pasteBtn && navigator.clipboard) {
        pasteBtn.addEventListener('click', async function () {
          try {
            const text = await navigator.clipboard.readText();
            if (text && /^https?:\/\//i.test(text.trim())) {
              proofLinkInput.value = text.trim();
              proofLinkInput.focus();
            } else {
              alert('Clipboard does not contain a URL. Copy the confirmation or Drive link and try again.');
            }
          } catch (err) {
            console.error('Clipboard read failed', err);
            alert('Could not read clipboard. Please paste the link manually.');
          }
        });
      }

      // Email button opens mail client; user must attach file manually
      if (emailProofBtn) {
        emailProofBtn.addEventListener('click', function () {
          const name = (document.getElementById('full-name') || {}).value || '[applicant name]';
          const email = (document.getElementById('email') || {}).value || '';
          const phone = (document.getElementById('phone') || {}).value || '';
          const subject = encodeURIComponent(`Proof of income from ${name}`);
          const bodyLines = [
            `Applicant: ${name}`,
            `Email: ${email}`,
            `Phone: ${phone}`,
            '',
            'Attached: (please attach your proof of income to this email)',
            '',
            'Property (if applicable):',
            ''
          ];
          const body = encodeURIComponent(bodyLines.join('\n'));
          window.location.href = `mailto:${EMAIL_ADDRESS}?subject=${subject}&body=${body}`;
        });
      }

      // Toggle which flow is visible
      function updateFlows() {
        const selected = document.querySelector('input[name="proof_option"]:checked')?.value;
        if (googleFlow) googleFlow.style.display = selected === 'google_form' ? 'block' : 'none';
        if (emailFlow) emailFlow.style.display = selected === 'email' ? 'block' : 'none';
      }
      proofOptionRadios.forEach(r => r.addEventListener('change', updateFlows));
      updateFlows();

      // Form submit validation: require proof link when Google Form selected; email path reminds user
      if (form) {
        form.addEventListener('submit', function (e) {
          const selected = document.querySelector('input[name="proof_option"]:checked')?.value;
          const link = (proofLinkInput && proofLinkInput.value || '').trim();

          if (selected === 'google_form') {
            if (!link) {
              e.preventDefault();
              alert('You selected Google Form upload. Please paste the confirmation or Drive link from the Google Form into the field so we can locate your file (or upload now and then paste the link).');
              if (proofLinkInput) proofLinkInput.focus();
              return false;
            }
          } else if (selected === 'email') {
            if (!confirm('You selected Email. After submitting this application, please send an email with your attachment to info.newfoundliving@gmail.com including your full name and property address so we can match it. Click OK to submit.')) {
              e.preventDefault();
              return false;
            }
          }
          // leave form to submit to Formspree
          return true;
        });
      }
    })();
  </script>
</body>
</html>
